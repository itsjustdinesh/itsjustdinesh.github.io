<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PricePilot — Quick Price Compare</title>
  <style>
    :root{
      --bg:#f8fafc; --card:#fff; --muted:#667085; --accent:#0ea5a4;
      --shadow:0 6px 18px rgba(15,23,42,0.08);
      font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
    }
    body{margin:0;background:var(--bg);color:#0f172a;padding:28px;-webkit-font-smoothing:antialiased;}
    .wrap{max-width:980px;margin:0 auto;}
    header{display:flex;gap:16px;align-items:center;margin-bottom:12px;}
    .logo{width:64px;height:64px;border-radius:12px;
      background:linear-gradient(135deg,#06b6d4,#0891b2);color:#fff;
      display:flex;align-items:center;justify-content:center;
      font-weight:700;font-size:20px;box-shadow:var(--shadow);}
    h1{margin:0;font-size:22px;}
    p.lead{margin:4px 0 0;color:var(--muted);font-size:14px;}
    .card{background:var(--card);padding:18px;border-radius:12px;
      box-shadow:var(--shadow);margin-bottom:18px;}
    form.grid{display:grid;grid-template-columns:1fr 160px;gap:12px;align-items:end;}
    .input,.small{width:100%;padding:10px 12px;border-radius:8px;
      border:1px solid #e6eef3;background:#fff;font-size:14px;}
    .small{padding:8px 10px;}
    label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px;}
    button.primary{background:var(--accent);color:#fff;border:0;padding:10px 14px;
      border-radius:8px;cursor:pointer;font-weight:600;}
    .result-list{margin-top:16px;display:grid;gap:10px;}
    .row{display:flex;justify-content:space-between;align-items:center;
      padding:12px;border-radius:10px;border:1px solid #eef3f7;
      background:linear-gradient(180deg,#fff,#fbfdff);}
    .price{font-size:18px;font-weight:700;color:#05264b;}
    .meta{font-size:13px;color:var(--muted);}
    .market-links{display:flex;gap:8px;align-items:center;}
    .market{padding:8px 10px;border-radius:8px;background:#f1f8f9;
      border:1px solid #e6f3f3;cursor:pointer;font-size:13px;text-decoration:none;color:#064e49;}
    .hint{font-size:13px;color:var(--muted);margin-top:8px;}
    .status{padding:10px 12px;border-radius:8px;background:#05264b;color:#fff;
      margin-bottom:12px;display:flex;justify-content:space-between;align-items:center;}
    .status .ok{color:#8ff;font-weight:700;}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">PP</div>
      <div style="flex:1">
        <h1>PricePilot</h1>
        <p class="lead">Find the best price fast — compare across Zepto, Blinkit & BigBasket (demo)</p>
      </div>
    </header>

    <div id="statusBar" class="status">PricePilot status: <span id="statusText" class="ok">initializing…</span></div>

    <section class="card">
      <h2 style="margin:0 0 10px 0">Search</h2>
      <form class="grid" onsubmit="return false;">
        <div>
          <label for="item">Item to search</label>
          <input id="item" class="input" placeholder="e.g. Milk" required />
        </div>

        <div>
          <label for="qty">Quantity</label>
          <div style="display:flex; gap:8px;">
            <input id="qty" type="number" min="1" value="1" class="input" style="flex:1" />
            <select id="unitSelect" class="small">
              <option value="kg">kg</option>
              <option value="l">l</option>
            </select>
          </div>
        </div>

        <div>
          <label for="place">Place (city)</label>
          <input id="place" class="input" placeholder="e.g. Hyderabad" />
        </div>

        <div>
          <label for="pin">Pincode</label>
          <input id="pin" class="input" placeholder="e.g. 500081" />
        </div>

        <div style="grid-column:1/-1; display:flex; gap:8px; margin-top:6px;">
          <div style="flex:1"><button id="searchBtn" class="primary" type="button">Search best price</button></div>
          <div style="display:flex;gap:8px;">
            <button id="resetBtn" class="small" type="button">Reset</button>
          </div>
        </div>
      </form>

      <div id="results" class="result-list"></div>
      <div class="hint">Click a marketplace to open its site with the search applied.</div>
    </section>
  </div>

  <script>
    const statusText = document.getElementById("statusText");
    function setStatus(msg, ok=true){ statusText.textContent = msg; statusText.style.color = ok?"#8ff":"#ffb3b3"; }

    const PRICES = {
      "milk": [
        { marketplace: "BigBasket", price: 50, url_template: "https://www.bigbasket.com/ps/?q={query}&nc=as" },
        { marketplace: "Zepto",     price: 55, url_template: "https://www.zepto.com/search?query={query}" },
        { marketplace: "Blinkit",   price: 60, url_template: "https://blinkit.com/s/?q={query}" }
      ],
      "quick sugar 1kg": [
        { marketplace: "BigBasket", price: 80, url_template: "https://www.bigbasket.com/ps/?q={query}&nc=as" },
        { marketplace: "Zepto",     price: 100, url_template: "https://www.zepto.com/search?query={query}" },
        { marketplace: "Blinkit",   price: 110, url_template: "https://blinkit.com/s/?q={query}" }
      ]
    };

    function buildQueryText(item, qty, unit){
      const it = item.trim();
      if (!qty) return it;
      if (/(kg|l|litre|liter|ltr)/i.test(it)) return it;
      const ut = unit==="l" ? (qty+" l") : (qty+" kg");
      return it+" "+ut;
    }
    function buildSearchLink(template, itemQuery, qty, unit){
      const q = encodeURIComponent(buildQueryText(itemQuery, qty, unit));
      return template.replace("{query}", q);
    }
    function findPricesFor(itemName){
      const keyExact = itemName.trim().toLowerCase();
      if (PRICES[keyExact]) return PRICES[keyExact];
      for (const k in PRICES){ if (k.includes(keyExact) || keyExact.includes(k)) return PRICES[k]; }
      return null;
    }
    function renderResults(list,itemQuery,qty,unit){
      const c=document.getElementById("results"); c.innerHTML="";
      if(!list){ c.innerHTML="<div class='hint'>No prices found. Try editing dataset.</div>"; return;}
      list.sort((a,b)=>a.price-b.price);
      for(const entry of list){
        const row=document.createElement("div"); row.className="row";
        const left=document.createElement("div"); left.innerHTML=`<div class="price">₹ ${entry.price}</div><div class="meta">${entry.marketplace}</div>`;
        const right=document.createElement("div"); right.className="market-links";
        const btn=document.createElement("a"); btn.className="market"; btn.innerText="Open";
        btn.href=buildSearchLink(entry.url_template,itemQuery,qty,unit); btn.target="_blank";
        right.appendChild(btn); row.appendChild(left); row.appendChild(right); c.appendChild(row);
      }
    }

    document.getElementById("searchBtn").addEventListener("click",()=>{
      const item=document.getElementById("item").value;
      const qty=document.getElementById("qty").value||1;
      const unit=document.getElementById("unitSelect").value||"kg";
      if(!item){alert("Enter an item");return;}
      const found=findPricesFor(item);
      renderResults(found,item,qty,unit);
    });
    document.getElementById("resetBtn").addEventListener("click",()=>{
      document.getElementById("item").value="";
      document.getElementById("qty").value=1;
      document.getElementById("place").value="";
      document.getElementById("pin").value="";
      document.getElementById("results").innerHTML="";
    });

    window.addEventListener("load",()=>{setStatus("loaded — dataset keys: "+Object.keys(PRICES).join(", "));});
  </script>
</body>
</html>
